import UIKit



// Semaphore ì„¸ë§ˆí¬ì–´
// ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ ê³µìœ  ìì› ì ‘ê·¼ì„ ì œì–´í•˜ê¸° ìœ„í•œ ë™ê¸°í™” ë„êµ¬
// ë™ì‹œ ì ‘ê·¼ ìˆ˜ ì œí•œì´ í•„ìš”í•œ ìƒí™©ì—ì„œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©
// ê³¼ë„í•œ wait() ë°ë””ë½ ìœ„í—˜ì„±ì´ ìˆìŒ.

let semaphore = DispatchSemaphore(value: 2)

for i in 1...5 {
    DispatchQueue.global().async {
        semaphore.wait()
        print("ğŸ”§ ì‘ì—… ì‹œì‘: \(i)")
        sleep(2)
        print("âœ… ì‘ì—… ì¢…ë£Œ: \(i)")
        semaphore.signal()
    }
}


// ë®¤í…ìŠ¤(Mutex) - í•œë²ˆì— í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ì„ê³„ êµ¬ì—­ì„ì— ì ‘ê·¼í•˜ë„ë¡ ë³´ì¥í•˜ëŠ” ìƒí˜¸ ë°°ì œ ì¥ì¹˜ ê³µìœ  ìì›ì˜ ì •í•©ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•œ ê°€ì¥ ê¸°ì´ˆì ì´ê³  ê°•ë ¥í•œ ë™ê¸°í™” ë„êµ¬ ì…ë‹ˆë‹¤.

// 1. ìŠ¤ë ˆë“œ Aê°€ lock() í˜¸ì¶œ -> ì ê¸ˆ ì„±ê³µ
// 2. ìŠ¤ë ˆë“œ Bê°€ lock() í˜¸ì¶œ -> ìŠ¤ë ˆë“œ Aê°€ unlock() í•˜ê¸° ì „ê¹Œì§€ ëŒ€ê¸°(block)
// 3. ìŠ¤ë ˆë“œ Aê°€ unlock() -> Bê°€ lock íšë“
// ì´ë¡œ ì¸í•´ race condition, data corruptionì„ ë°©ì§€ í•  ìˆ˜ ìˆë‹¤.

